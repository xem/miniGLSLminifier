<h3>Mini GLSL minifier (WebGL 1.0 / 2.0)</h3>
<p>- Removes comments
<br>- Removes unnecessary spaces, tabs, line breaks
<br>- Removes unnecessary zeroes in floats ("0." / ".0")
<br>- Inserts "\n" after the #macros to keep all the code on a single line
<p>

<textarea id=t cols=100 rows=10 placeholder="Paste GLSL code here"></textarea>

<script>
t.oninput=()=>{
  t.value=t.value.replace(/\\n/g,"\n")
                 .replace(/(#.*?)\s*\n/g,"$1\\n")
                 .replace(/(\/\*[^]+?\*\/|\/\/.*|\s)+/g," ")
                 .replace(/ *([;,.{}[\]()+*\/<>=!&|^-]) */g,"$1")
                 .replace(/(\d\.\d*?)0+|(\D)0+(\d*\.\d)/g, "$1$2$3")
}
</script>

<p><b>Test shader:</b>
<p><pre style=background:#eee;padding:10px>
#version 300 es    

precision mediump float;
uniform vec3 light;
in vec3 v_position;
in vec4 v_color;
out vec4      c;\n
#define PI 3\n

void main() { /* compute fragment */
  vec4 testFloats = vec4(010.00, 01.1200, 0.02030, 00.);
  vec4 testInts = vec4(0, 00, 010, 001);
  c = vec4(
    v_color.rgb * (
      max(dot(light, normalize(cross(dFdx(v_position), dFdy(v_position)))), 0.0) // ambient light
      + 0.200 // diffuse light
    ), 010
  );
}
</pre>

